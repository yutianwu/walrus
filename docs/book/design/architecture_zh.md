# 基础架构和安全假设

Walrus 架构中的关键参与者如下：

- **用户**通过**客户端**希望存储和读取由其 **blob ID** 标识的 **blobs**。

  这些参与者在写入和非尽力而为读取时愿意为服务付费。用户还希望向第三方证明 blob 的**可用性**，而无需发送或接收完整 blob 的成本。

  用户可能以各种方式恶意行为：他们可能不想为服务付费，证明不可用 blobs 的可用性，未经授权修改/删除 blobs，试图耗尽存储节点的资源等等。

- **存储节点**在一个**存储纪元**内持有一个或多个**分片**。

  每个 blob 被纠删编码为许多 **slivers**。来自每个存储 blob 的 slivers 成为所有分片的一部分。在任何存储纪元中的分片都与实际存储该分片所有 slivers 并准备为其提供服务的存储节点相关联。

  Sui 智能合约控制在**存储纪元**（主网上为 2 周）内将分片分配给存储节点，Walrus 假设在每个存储纪元内超过 2/3 的分片由正确的存储节点管理。这意味着 Walrus 必须容忍每个存储纪元内和跨存储纪元最多 1/3 的分片由拜占庭存储节点管理（大约 1/3 的存储节点是拜占庭的）。

- 所有客户端和存储节点都运行区块链客户端（特别是在 Sui 上），并通过区块链智能合约调解支付、资源（空间）、分片到存储节点的映射和元数据。用户与区块链交互以获取存储资源并为存储的 blobs 上传证书。存储节点监听区块链事件以协调其操作。

Walrus 支持任意数量的可选基础设施参与者，这些参与者可以无需许可的方式运行：

- **聚合器**是从 slivers 重构 blobs 并通过传统 web2 技术（如 HTTP）向用户提供的客户端。它们是可选的，因为最终用户可以直接重构 blobs 或运行本地聚合器在本地通过 web2 技术执行 Walrus 读取。

- **缓存**是具有额外缓存功能的聚合器，以减少延迟并减少存储节点的负载。此类缓存基础设施还可能充当 CDN，在许多请求中分摊 blob 重构的成本，具有更好的连接等。客户端始终可以验证从此类基础设施的读取是否正确。

- **发布者**是帮助最终用户使用 web2 技术存储 blob 的客户端，使用更少的带宽和自定义逻辑。

  实际上，他们通过传统 web2 协议（如 HTTP）接收要发布的 blob，并代表最终用户运行 Walrus 存储协议。这包括将 blob 编码为 slivers，将 slivers 分发到存储节点，收集存储节点签名并将其聚合为证书，以及所有其他链上操作。

  它们是可选的，因为用户可以直接与 Sui 和存储节点交互来存储 blobs。最终用户始终可以通过检查与 blob 的**[可用性点](./properties_zh.md)**相关的事件是否存在于链上，然后执行读取以查看 Walrus 是否返回 blob 或编码 blob 并将结果与证书中的 blob ID 进行比较，来验证发布者是否正确履行了其职责。

聚合器、发布者和最终用户不被视为系统的可信组件，它们可能任意偏离协议。但是，Walrus 的一些安全属性仅对使用诚实中介（缓存和发布者）的诚实最终用户有效。Walrus 提供了最终用户审计缓存和发布者正确操作的手段。